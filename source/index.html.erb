<div id="home" class="banner height-all-screen-navbar text-white" >
 <%= partial "shared/banner_info" %>
 <%= partial "shared/navbar" %>
</div>

<div class="overflow">
<section id="about-me">
  <div class="container d-flex align-items-center justify-content-center flex-column">
    <h1 data-aos="fade-right" data-aos-once="true">Qui suis-je?</h1>
    <div class="header-bar" data-aos="fade-right" data-aos-delay="50" data-aos-once="true"></div>
    <div class="row">
      <div class="col">
      </div>
    </div>
  </div>
</section>
<section id="skills">
  <div class="container d-flex align-items-center justify-content-center flex-column">
    <h1 data-aos="fade-left" data-aos-once="true">Compétences</h1>
    <div class="header-bar" data-aos="fade-left" data-aos-delay="50" data-aos-once="true"></div>
    <div class="row">
      <div class="col">
      </div>
    </div>
  </div>
</section>
<section id="portfolio">
  <div class="container d-flex align-items-center justify-content-center flex-column">
    <h1 data-aos="fade-right" data-aos-once="true">Portfolio</h1>
    <div class="header-bar" data-aos="fade-right" data-aos-delay="50" data-aos-once="true"></div>
    <div class="row">
      <div class="col">
      </div>
    </div>
  </div>
</section>

<section id="contact">
  <<div class="container d-flex align-items-center justify-content-center flex-column">
    <h1 data-aos="fade-left" data-aos-once="true">Contact</h1>
    <div class="header-bar" data-aos="fade-left" data-aos-delay="50" data-aos-once="true"></div>
    <div class="row mt-4">
      <div class="col">
        <form id="contactForm" method="POST" name="contactForm" class="contactForm">
          <div class="form-group">
            <input type="text"  name="name" placeholder="Nom*" required>
            <input type="email" name="email" placeholder="Email*" required>
            <textarea type="text" name="message" placeholder="Message*" required></textarea>
          </div>
          <div id="success">
            <div>Votre message a été envoyé avec succès. Merci !
              <span id="close" class="mdi"><i class="fas fa-times"></i></span>
            </div>
          </div>
          <input type="submit" value="Envoyer" id="submit">
        </form>
      </div>
    </div>
  </div>
</section>
</div>

<%= partial "shared/footer" %>

<script>
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        document.querySelector(this.getAttribute('href')).scrollIntoView({
            behavior: 'smooth'
        });
    });
  });
 // SEND EMAIL FROM CONTACT FORM
 const form = document.getElementById('contactForm');
 const formspreeEmail = 'carine.le.charles@gmail.com';
 const success = document.getElementById('success');
 const close = document.getElementById('close');
    // Convert form data to json
    const formDataToJson = formData => {
      const entries = formData.entries();
      const dataObj = Array.from(entries).reduce( (data, [key, value]) => {
        data[key] = value;
        if (key === "email") {
          data._replyTo = value;
        }
        return data;
      }, {});
      return JSON.stringify(dataObj);
    };

    //Post request with fetch
    form.addEventListener('submit', (e) => {
      e.preventDefault();

      const formData = new FormData(form);
      formData.append('_subject', 'Message from CLC website');

      fetch(`https://formspree.io/${ formspreeEmail }`, {
        method: 'POST',
        body: formDataToJson(formData),
        headers: {
          'Content-Type': 'application/json'
        }
      })
      .then(response => response.json())
      .then(data => {
        if (data.success === 'email sent') {
          success.classList.add("expand");
          form.reset();
        };
      });
    });

    close.addEventListener('click', () => {
      success.classList.remove("expand");
    });

// BANNER TYPED.JS

  const typed = document.getElementById("typed");
  if (typed) {
    new Typed("#typed", {
      strings: [
      "Bonjour !<br><br>Je m'appelle Carine. <br>Je suis développeuse web full stack.<br><br>Faisons connaisance..."
      ],
      typeSpeed: 50
    });
  }


const bannerInfo = document.getElementById("banner-info");
const navbar = document.getElementById("navbar");
const logoNavbar = document.getElementById("logo");
const logoNavbarPhone = document.getElementById("logo-navbar-phone");
const hamb = document.getElementById("toggle");
const overlay = document.getElementById("overlay");
const body = document.body;
// BANNER INFO DISAPPEARS ON SCROLL
window.addEventListener("scroll", () => {
  if (bannerInfo) {
    if (scrollY > 160) {
      bannerInfo.classList.remove("display-banner-info");
      bannerInfo.classList.add("hide-banner-info");
    } else {
      bannerInfo.classList.remove("hide-banner-info");
      bannerInfo.classList.add("display");
    }
  }
});

// NAVBAR STYLE CHANGE ON SCROLL
window.addEventListener("scroll", () => {
  if (navbar) {
    if (window.scrollY >= window.innerHeight) {
      navbar.classList.remove("bg-transparent");
      navbar.classList.add("navbar-fixed");
      logoNavbar.src = "images/logo-yellow.png";
    } else {
      navbar.classList.remove("navbar-fixed");
      navbar.classList.add("bg-transparent");
      logoNavbar.src = "images/logo-grey.png";
    }
  }
});

// DISPLAY LOGO NAVBAR IN PHONE SCREEN
window.addEventListener("scroll", () => {
  if (navbar) {
    if (window.scrollY >= window.innerHeight) {
      logoNavbarPhone.classList.remove("invisible");
      logoNavbarPhone.classList.add("visible");
    } else {
      logoNavbarPhone.classList.remove("visible");
      logoNavbarPhone.classList.add("invisible");
    }
  }
});

// OPEN MENU HAMBURGER
hamb.addEventListener("click", () => {
 hamb.classList.toggle('active');
 overlay.classList.toggle('open');
 body.classList.toggle('noscroll');
});
</script>
